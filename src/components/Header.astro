---
// Header.astro - Con logo SVG desde public/

const navItems = [
  { name: 'Funciones', href: '#funciones', description: 'QR, rutinas, pagos automáticos' },
  { name: 'Roles', href: '#roles', description: 'Para admin, profesores y miembros' },
  { name: 'Beneficios', href: '#beneficios', description: 'ROI y resultados reales' },
  { name: 'Precios', href: '#precios', description: 'Desde $50,000/mes' },
  { name: 'Lista de Espera', href: '#lista-espera', description: 'Asegura tu lugar' }
];
---

<header class="header-main fixed w-full top-0 z-50 bg-black/95 backdrop-blur-lg border-b border-gray-800 shadow-sm transition-all duration-300 ease-in-out">
  <div class="container mx-auto px-6">
    <div class="flex justify-between items-center py-4">
      <!-- Logo SVG -->
      <div class="flex items-center">
        <a href="/" class="flex items-center hover:opacity-80 transition-all group">
          <!-- OPCIÓN 1: Logo SVG desde public/ -->
          <img 
            src="/images/logo-massup.svg" 
            alt="mass-up logo"
            class="h-14 w-auto mr-3 group-hover:scale-105 transition-transform"
          />
          
          <!-- Texto opcional junto al logo -->
          
        </a>
      </div>

      <!-- Desktop Navigation -->
      <nav class="hidden lg:flex items-center space-x-8">
        {navItems.map((item) => (
          <div class="nav-item group relative">
            <a 
              href={item.href}
              class="flex items-center text-gray-300 hover:text-amber-400 font-medium transition-colors py-2"
            >
              {item.name}
              <svg class="w-4 h-4 ml-1 opacity-60" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
              </svg>
            </a>
            
            <!-- Dropdown tooltip -->
            <div class="nav-dropdown absolute top-full left-1/2 transform -translate-x-1/2 mt-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200">
              <div class="bg-gray-900 rounded-lg shadow-lg border border-gray-700 p-3 whitespace-nowrap">
                <p class="text-sm text-gray-300">{item.description}</p>
                <div class="absolute -top-1 left-1/2 transform -translate-x-1/2 w-2 h-2 bg-gray-900 border-l border-t border-gray-700 rotate-45"></div>
              </div>
            </div>
          </div>
        ))}
      </nav>

      <!-- CTA Buttons -->
      <div class="hidden lg:flex items-center space-x-3">
        <a 
          href="#lista-espera"
          class="px-4 py-2 text-amber-400 hover:text-amber-300 font-medium transition-colors"
        >
          Lista de Espera
        </a>
        <a 
          href="https://wa.me/+573181123660?text=Hola%20mass-up,%20quiero%20conocer%20más%20sobre%20la%20app%20para%20mi%20gimnasio"
          target="_blank"
          rel="noopener noreferrer"
          class="px-6 py-2 bg-amber-400 hover:bg-amber-500 text-black rounded-lg font-medium transition-all shadow-md hover:shadow-lg"
        >
          Empezar Gratis
        </a>
      </div>

      <!-- Mobile Menu Button -->
      <button 
        id="mobile-menu-button"
        class="lg:hidden flex items-center justify-center w-10 h-10 rounded-lg hover:bg-gray-800 transition-colors"
        aria-label="Abrir menú"
      >
        <svg class="w-6 h-6 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>
  </div>

  <!-- Mobile Menu (resto del código igual...) -->
  <div id="mobile-menu" class="lg:hidden fixed inset-0 bg-black/50 opacity-0 invisible transition-all duration-300 z-40">
    <div class="mobile-menu-panel absolute right-0 top-0 h-full w-80 bg-gray-900 shadow-xl transform translate-x-full transition-transform duration-300 ease-in-out">
      <div class="p-6">
        <!-- Mobile Header con logo -->
        <div class="flex justify-between items-center mb-8">
          <div class="flex items-center">
            <img 
              src="/images/logo-massup.svg" 
              alt="mass-up logo"
              class="h-8 w-auto mr-2"
            />
          </div>
          <button 
            id="mobile-menu-close"
            class="flex items-center justify-center w-8 h-8 rounded-lg hover:bg-gray-800 transition-colors"
            aria-label="Cerrar menú"
          >
            <svg class="w-5 h-5 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>

        <!-- Mobile Navigation -->
        <nav class="space-y-4 mb-8">
          {navItems.map((item) => (
            <a 
              href={item.href}
              class="mobile-nav-link block py-3 px-4 text-gray-300 hover:bg-gray-800 hover:text-amber-400 rounded-lg transition-colors"
            >
              <div class="font-medium">{item.name}</div>
              <div class="text-sm text-gray-500 mt-1">{item.description}</div>
            </a>
          ))}
        </nav>

        <!-- Mobile CTA Buttons -->
        <div class="space-y-3">
          <a 
            href="#lista-espera"
            class="mobile-nav-link block w-full py-3 px-4 border-2 border-amber-400 text-amber-400 hover:bg-amber-400 hover:text-black rounded-lg font-medium text-center transition-colors"
          >
            Unirme a Lista de Espera
          </a>
          <a 
            href="https://wa.me/+573181123660?text=Hola%20mass-up,%20quiero%20conocer%20más%20sobre%20la%20app%20para%20mi%20gimnasio"
            target="_blank"
            rel="noopener noreferrer"
            class="mobile-nav-link block w-full py-3 px-4 bg-amber-400 hover:bg-amber-500 text-black rounded-lg font-medium text-center transition-all shadow-md"
          >
            Hablar por WhatsApp
          </a>
        </div>
      </div>
    </div>
  </div>
</header>

<style>
  /* Logo styles */
  .header-main img {
    filter: brightness(1) contrast(1);
    transition: all 0.3s ease;
  }
  
  .header-main img:hover {
    filter: brightness(1.1) contrast(1.1);
  }
  
  /* Resto de estilos igual... */
  html {
    scroll-behavior: smooth;
  }
  
  .header-main {
    transform: translateY(0);
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  }
  
  .header-main.header-hidden {
    transform: translateY(-100%);
  }
  
  .header-main.header-shadow {
    box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.4), 0 4px 6px -2px rgba(0, 0, 0, 0.2);
  }
  
  #mobile-menu.active {
    opacity: 1;
    visibility: visible;
  }
  
  #mobile-menu.active .mobile-menu-panel {
    transform: translateX(0);
  }
  
  .nav-dropdown {
    transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  }
  
  .nav-item a.active {
    color: #fbbf24;
  }
  
  @supports (backdrop-filter: blur(12px)) {
    .header-main {
      backdrop-filter: blur(12px);
    }
  }
  
  @media (max-width: 768px) {
    .mobile-menu-panel {
      width: min(320px, 90vw);
    }
  }
</style>

<script>
  // JavaScript igual al anterior...
  document.addEventListener('DOMContentLoaded', function() {
    const mobileMenuButton = document.getElementById('mobile-menu-button') as HTMLButtonElement | null;
    const mobileMenu = document.getElementById('mobile-menu') as HTMLElement | null;
    const mobileMenuClose = document.getElementById('mobile-menu-close') as HTMLButtonElement | null;
    const mobileNavLinks = document.querySelectorAll('.mobile-nav-link') as NodeListOf<HTMLAnchorElement>;
    
    mobileMenuButton?.addEventListener('click', () => {
      mobileMenu?.classList.add('active');
      document.body.style.overflow = 'hidden';
    });
    
    const closeMobileMenu = () => {
      mobileMenu?.classList.remove('active');
      document.body.style.overflow = '';
    };
    
    mobileMenuClose?.addEventListener('click', closeMobileMenu);
    
    mobileMenu?.addEventListener('click', (e: Event) => {
      if (e.target === mobileMenu) {
        closeMobileMenu();
      }
    });
    
    mobileNavLinks.forEach(link => {
      link.addEventListener('click', closeMobileMenu);
    });
    
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (this: HTMLAnchorElement, e: Event) {
        e.preventDefault();
        const href = this.getAttribute('href');
        if (href) {
          const target = document.querySelector(href) as HTMLElement | null;
          if (target) {
            const headerHeight = 80;
            const targetPosition = target.offsetTop - headerHeight;
            
            window.scrollTo({
              top: targetPosition,
              behavior: 'smooth'
            });
          }
        }
      });
    });
    
    const updateActiveNavigation = () => {
      const sections = document.querySelectorAll('section[id]') as NodeListOf<HTMLElement>;
      const navLinks = document.querySelectorAll('nav a[href^="#"]') as NodeListOf<HTMLAnchorElement>;
      
      let currentSection = '';
      const scrollPosition = window.scrollY + 100;
      
      sections.forEach(section => {
        const sectionTop = section.offsetTop;
        const sectionHeight = section.offsetHeight;
        
        if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
          currentSection = section.getAttribute('id') || '';
        }
      });
      
      navLinks.forEach(link => {
        link.classList.remove('active');
        const href = link.getAttribute('href');
        if (href === `#${currentSection}`) {
          link.classList.add('active');
        }
      });
    };
    
    let lastScrollY = window.scrollY;
    let ticking = false;
    const header = document.querySelector('.header-main') as HTMLElement | null;
    
    const handleScroll = () => {
      const currentScrollY = window.scrollY;
      
      if (currentScrollY > lastScrollY && currentScrollY > 100) {
        header?.classList.add('header-hidden');
      } else {
        header?.classList.remove('header-hidden');
      }
      
      if (currentScrollY > 10) {
        header?.classList.add('header-shadow');
      } else {
        header?.classList.remove('header-shadow');
      }
      
      lastScrollY = currentScrollY;
      updateActiveNavigation();
    };
    
    window.addEventListener('scroll', () => {
      if (!ticking) {
        requestAnimationFrame(() => {
          handleScroll();
          ticking = false;
        });
        ticking = true;
      }
    }, { passive: true });
    
    window.addEventListener('resize', () => {
      if (window.innerWidth >= 1024) {
        closeMobileMenu();
      }
    });
    
    document.addEventListener('keydown', (e: KeyboardEvent) => {
      if (e.key === 'Escape') {
        closeMobileMenu();
      }
    });
  });
</script>